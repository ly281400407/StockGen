<!DOCTYPE html>
<html>
<head>
	<title>Object-based init</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<link rel="stylesheet" type="text/css" href="dhtmlx/fonts/font_roboto/roboto.css"/>
	<link rel="stylesheet" type="text/css" href="dhtmlx/dhtmlx.css"/>
	<link rel="stylesheet" type="text/css" href="dhtmlx/skins/web/dhtmlx.css"/>
	<link rel="stylesheet" type="text/css" href="dhtmlx/skins/terrace/dhtmlx.css"/>
	<link rel="stylesheet" type="text/css" href="dhtmlx/skins/skyblue/dhtmlx.css"/>	
	<script src="jquery/jquery-1.12.4.min.js"></script>
	<script src="dhtmlx/dhtmlx.js"></script>
	<script src="https://code.highcharts.com/stock/highstock.js"></script>
	<script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
	<style>
		div#layoutObj {
			width: 99.9%;
			height: 750px;
		}
	</style>
	<script>
		var clientHeight = window.innerHeight;
		var clientWidth = window.innerWidth;
		var navigationHeight;
		var viewWidth;
		var layoutObj;
		var myLayout;
		
		function doOnLoad() {
			initMenu();
			initLayout();
			initTree();
			initWindow();
		}
		
		//初始化菜单
		function initMenu(){
			var myMenu = new dhtmlXMenuObject("menuObj");
			myMenu.setSkin("dhx_web");
			myMenu.setIconsPath("dhtmlx/imgs/imgs/");
			myMenu.loadFromHTML("menuData", true);
		}

		//初始化布局	
		function initLayout(){
			navigationHeight = clientHeight - document.getElementById("menuObj").offsetHeight;
			layoutObj = document.getElementById("layoutObj");
			viewWidth = clientWidth - 250;
			myLayout = new dhtmlXLayoutObject({
			 
			    parent:     "layoutObj",    // id/object, parent container where layout will be located
			    pattern:    "2U",           // string, layout's pattern
			    skin:       "dhx_web",
			    offsets: {          // optional, offsets for fullscreen init
			        top:    5,     // you can specify all four sides
			        right:  5,     // or only the side where you want to have an offset
			        bottom: 5,
			        left:   5
			    },
			 
			    cells: [    // optional, cells configuration according to the pattern
			                // you can specify only the cells you want to configure
			                // all params are optional
			        {
			            id:             "a",        // id of the cell you want to configure
			            text:           "navigation",     // header text
			            header:         true,      // hide header on init
			            width:          250,        // cell init width
			            height:         navigationHeight,        // cell init height
			            collapse:       false,        // collapse on init
			            fix_size:       [true,null] // fix cell's size, [width,height]
			        },
			        {
			            id:             "b",        // id of the cell you want to configure
			            text:           "view",     // header text
			            header:         true,      // hide header on init
			            width:          viewWidth,        // cell init width
			            height:         navigationHeight-250,        // cell init height
			            collapse:       false,        // collapse on init
			            fix_size:       [true,null] // fix cell's size, [width,height]
			        }
			    ]
			});
		}


		//初始化导航树
		function initTree(){
			$.getJSON('get_Tree_data', function(data){
				debugger;
				var treeData = data["data"];
				var cells = myLayout.cells("a");
				var myTree = cells.attachTree();
				myTree.setSkin("dhx_web");
				myTree.setImagesPath("dhtmlx/imgs/dhxtree_material/");
				myTree.parse(treeData,"json");
				myTree.attachEvent("onDblClick", function(id){
					var nodeName = myTree.getItemText(id);
					alert(nodeName);
				});
			});

		}

		//初始化主题窗口
		function initWindow(){
			var divString = "<div id='windowDiv' style='position: relative;height:"+(navigationHeight-250)+"px;width:"+viewWidth+"px;'/>"
			myLayout.cells("b").attachHTMLString(divString);
			var dhxWins = new dhtmlXWindows();
			dhxWins.setSkin("dhx_web");
			dhxWins.attachViewportTo("windowDiv");
			var w1 = dhxWins.createWindow("w1", 20, 30, 400, 280);
			w1.setText("表格");
			var grid = document.getElementById("tableData");
			w1.attachObject(grid);

			var w2 = dhxWins.createWindow("w2", 20, 30, 400, 280);
			w2.setText("k线图");
			

			$.getJSON('https://www.highcharts.com/samples/data/jsonp.php?a=e&filename=aapl-ohlc.json&callback=?', function (data) {
				debugger;
		        // create the chart
		        $("#stockMain").highcharts('StockChart', {


		            rangeSelector : {
		                selected : 1
		            },

		            title : {
		                text : 'AAPL Stock Price'
		            },

		            series : [{
		                type : 'candlestick',
		                name : 'AAPL Stock Price',
		                data : data,
		                dataGrouping : {
		                    units : [
		                        [
		                            'week', // unit name
		                            [1] // allowed multiples
		                        ], [
		                            'month',
		                            [1, 2, 3, 4, 6]
		                        ]
		                    ]
		                }
		            }]
		        });
		        var stockMain = document.getElementById("stockMain");
		        w2.attachObject(stockMain);	

		    });		
		}


	</script>
</head>
<body onload="doOnLoad();">
	<div id="menuObj"></div>
	<div id="layoutObj"></div>
 	<div id="menuData" style="display: none;">
		<div id="file" text="File">
			<div id="new" text="New" img="new.gif"></div>
			<div id="file_sep_1" type="separator"></div>
			<div id="open" text="Open" img="open.gif"></div>
			<div id="save" text="Save" img="save.gif"></div>
			<div id="saveAs" text="Save As..." imgdis="save_as_dis.gif" enabled="false"></div>
			<div id="file_sep_2" type="separator"></div>
			<div id="print" text="Print" img="print.gif"></div>
			<div id="pageSetup" text="Page Setup" imgdis="page_setup_dis.gif" enabled="false"></div>
			<div id="file_sep_3" type="separator"></div>
			<div id="close" text="Close" img="close.gif"></div>
		</div>
		<div id="m2" text="Edit">
			<div id="undo" text="Undo" img="undo.gif"></div>
			<div id="redo" text="Redo" img="redo.gif"></div>
			<div id="edit_sep_1" type="separator"></div>
			<div id="selectAll" text="Select All" img="select_all.gif"></div>
			<div id="edit_sep_2" type="separator"></div>
			<div id="cut" text="Cut" img="cut.gif"></div>
			<div id="cpoy" text="Copy" img="copy.gif"></div>
			<div id="paste" text="Paste" img="paste.gif"></div>
		</div>
		<div id="m3" text="Help">
			<div id="about" text="About..." img="about.gif"></div>
			<div id="help" text="Help" img="help.gif"></div>
			<div id="bugReporting" text="Bug Reporting" img="bug_reporting.gif"></div>
		</div>
	</div>
	<div style="display:none;">
		<table id="tableData" class="dhtmlxGrid">
			<tr>
				<td width="150" align="left">Book</td>
				<td type="co" sort="str">Author</td>
				<td type="edn" format="0,000.00">Price</td>
				<td>Sales</td>
			</tr>
			<tr>
				<td width="150" align="left">java</td>
				<td type="co" sort="str">m.c.a</td>
				<td type="edn" format="0,000.00">100</td>
				<td>上海出版社</td>
			</tr>
			<tr>
				<td width="150" align="left">java</td>
				<td type="co" sort="str">m.c.a</td>
				<td type="edn" format="0,000.00">100</td>
				<td>上海出版社</td>
			</tr>					
		</table>
		<div style="display:none" id="stockMain"></div>	
	</div>
</body>
</html>